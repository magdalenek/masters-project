<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="css/general-style.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap-theme.min.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="http://d3js.org/topojson.v1.min.js"></script>
    <script src="http://d3js.org/queue.v1.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <title>Charitable</title>
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>

    <![endif]-->
</head>
<style type="text/css">

    .water {
        fill: #43b8d1;
    }

    .land {
        fill: #f5e1d1;
        stroke: #f5e1d1;
        stroke-width: 0.7px;
    }

    .land:hover {
        fill:pink;
        stroke-width: 1px;
    }

    .focused {
        fill: pink;
    }

    select {
        position: absolute;
        top: 20px;
        left: 580px;
        border: solid #ccc 1px;
        padding: 3px;
        box-shadow: inset 1px 1px 2px #ddd8dc;
        visibility: hidden;
    }

    .countryTooltip {
        position: absolute;
        display: none;
        pointer-events: none;
        background: #fff;
        padding: 5px;
        text-align: left;
        border: solid #ccc 1px;
        color: #666;
        font-size: 14px;
        font-family: sans-serif;
    }
</style>

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">

<!--NAVBAR-->
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
        <div class="navbar-header page-scroll">
            <a class="navbar-brand page-scroll" href="#page-top">
                <img class="img-responsive" src="images/heart-gray.png" style="display: inline;" alt="" width="5%" height="5%" />
                <p class="orator-header-small" style="display: inline;" >CHARITABLE</p>
            </a>
        </div>

        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav navbar-right">
                <li class="hidden">
                    <a class="page-scroll" href="#page-top"></a>
                </li>
                <li>
                    <a class="page-scroll" href="#donate"><h6 class="orator-header-small">Donate</h6></a>
                </li>
                <li>
                    <a class="page-scroll" href="#about"><h6 class="orator-header-small">About</h6></a>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button"><h6 class="orator-header-small">Login/Register</h6>
                    <ul class="dropdown-menu">
                        <li><a href="http://localhost:9052"><h6 class="orator-header-small">User</h6></a></li>
                        <li><a href="http://localhost:9051/add-charity.html"><h6 class="orator-header-small">Charity</h6></a></li>
                    </ul>
            </ul><!-- end dropdown-menu -->
        </div>
    </div>
</nav>

<!--MAIN IMAGE-->
    <img class="img-responsive center-block" src="images/don2.png" width="120%" height="120%" style="padding-top: 3%">

<!--MAPS-->
    <div class="container-fluid blue" id="donate">
        <hr class="featurette-divider">
    <img class="center-block" src="images/donate.png">
        <div class="row">
        <div class="col-sm-7 blue">
            <div class="container">
                <span></span>
            </div>
        </div>
            <div class="col-sm-4">
                <div class="featurette">
                    <br><br><br>
                    <img class="featurette-image img-circle img-responsive center-block" src="images/is.jpg" width="40%" height="40%">
                    <h6 class="featurette-heading">How does it work?</h6>
                    <p class="lead">Simply select the country that you are interest in donating to from the globe. You will then be able to see the list of all the charities that aim to donate to the place of your choice.</p>
                </div>
            </div>
        </div>
        </div>




    <div class="container-fluid">
    <div class="row">
        <div class="col-sm-12 dark-blue">
            <form class="form-inline">
                <div class="form-group">
                    <label for="search_input"><h2><span class="glyphicon glyphicon-search small" style="color: #000000;"></span> You can also search by the cause: </h2></label>
                    <input style="padding-left:5px;" type="text" id="search_input" class="form-control" />
                    <button onclick="searchCharities();" type="button" class="btn btn-danger">Search</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    function searchCharities() {
        var searchQuery = document.getElementById("search_input").value;
        var destination = "http://localhost:9051/search?searchQuery=" + searchQuery;
        var redirect = window.open(destination, "_blank").focus();
        redirect.location;
    }

</script>

    <!--ABOUT-->
    <hr class="featurette-divider" id="about">
    <img class="center-block" src="images/about.png">
    <!-- First Featurette -->
    <div class="featurette">
        <img class="featurette-image img-circle img-responsive pull-right" src="images/is.jpg" width="25%" height="25%">
        <br><br>
        <h6 class="featurette-heading">Do I really have a choice?

        </h6>
        <p class="lead">Although there are hundreds of thousands of non-profit orgnisations, and the number grows each year, most of our donations go to 10% largest organisations. Charitable's task is to help you find the right charity to donate to. Small, big, home, or abroad - just explore!</p>
    </div>

    <!-- Second Featurette -->
    <div class="featurette">
        <img class="featurette-image img-circle img-responsive pull-left" src="images/lets.jpg" width="25%" height="25%">
        <br><br>
        <h6 class="featurette-heading">Look for an alternative!
        </h6>
        <p class="lead">Huge number or charities can't even afford social media exposure. Charitable was funded to ensure every charity, regardless of size or income, has a fair chance to fight for their cause. We all should have a choice, right?</p>
    </div>

    <!-- Third Featurette -->
    <div class="featurette">
        <img class="featurette-image img-circle img-responsive pull-right" src="images/17182-NQZ5GJ.jpg" width="25%" height="25%">
        <h6 class="featurette-heading">Make a difference.
        </h6>
        <p class="lead">The charities featured on this website were verified and sourced for. So don't forget: the more charities sign up, the greater choice we all have. Spread the word. We can all make a difference.</p>
    </div>

    <hr class="featurette-divider">


</div><!--homePage-->



<!--Footer-->
<footer>
    <div class="container">
        <div class="row">
            <div class="container" id="footer-container">
                <div class="col-sm-12">
                    <div class="container" id="first-footer">
                        <div class="col-sm-2">
                            <h6>Copyright &copy; 2016</h6>
                            <p>ms915@imperial.ac.uk
                                Designed by Magdalena for Imperial College project.</p>
                        </div>
                        <div class="col-sm-3 visible-sm visible-md visible-lg">
                            <h6>About Charitable</h6>
                            <p>Charitable is a proof-of concept application designed for the Msc Computer Science Individual Project module at Imperial College London. Forgive imperfections. </p>
                            <div class="control-group">
                                <div class="controls">
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-2 visible-sm visible-md visible-lg">
                            <h6>Other Links</h6>
                            <ul class="unstyled">
                                <li><a href="http://localhost:9051/admin-login.html">Charitable Admin</a></li>
                                <li><a href="">Info</a></li>
                                <li><a href="">Contact</a></li>
                                <li><a href="">Feedback</a></li>
                                <li><a href="">Sponsors</a></li>
                            </ul>
                        </div>
                        <div class="col-sm-2">
                            <h6>Follow</h6>
                            <div id="share-buttons-footer">
                                <ul class="unstyled">

                                    <!-- Facebook -->
                                    <a href="http://www.facebook.com/sharer.php?u=http://www.simplesharebuttons.com" target="_blank"><img src="http://www.simplesharebuttons.com/images/somacro/facebook.png" alt="Facebook" />Facebook<br></a>

                                    <!-- Twitter -->
                                    <a href="http://twitter.com/share?url=http://www.simplesharebuttons.com&text=Simple Share Buttons&hashtags=simplesharebuttons" target="_blank"><img src="http://www.simplesharebuttons.com/images/somacro/twitter.png" alt="Twitter" />Twitter<br></a>

                                    <!-- Google+ -->
                                    <a href="https://plus.google.com/share?url=http://www.simplesharebuttons.com" target="_blank"><img src="http://www.simplesharebuttons.com/images/somacro/google.png" alt="Google" />Google+</a>
                            </div>
                            </ul>
                        </div>
                        <div class="col-sm-2 visible-sm visible-md visible-lg">
                            <h6>Legal jargon</h6>
                            <p>Images <a href="http://www.freepik.com">designed by Freepik</a></p>
                            <p>Work in progress - do not sue :)</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
</footer>


<!--SCRIPTS-->
<script src="js/bootstrap.min.js"></script>
<script src="js/jquery.js"></script>
<script src="js/jquery.easing.min.js"></script>
<script src="js/scrolling-nav.js"></script>


<!-- MAP CREATION-->
<script>

        var width = 700,
                height = 500,
                sens = 0.25,
                focused;

        //Setting projection
        var projection = d3.geo.orthographic()
                .scale(245)
                .rotate([0, 0])
                .translate([width / 2, height / 2])
                .clipAngle(90);

        var path = d3.geo.path()
                .projection(projection);

        //SVG container
        var svg = d3.select("span").append("svg")
                .attr("width", width)
                .attr("height", height);

        //Adding water
        svg.append("path")
                .datum({type: "Sphere"})
                .attr("class", "water")
                .attr("d", path)
                .call(d3.behavior.drag()
                .origin(function() { var r = projection.rotate(); return {x: r[0] / sens, y: -r[1] / sens}; })
                .on("drag", function() {
                            var rotate = projection.rotate();
                            projection.rotate([d3.event.x * sens, -d3.event.y * sens, rotate[2]]);
                            svg.selectAll("path.land").attr("d", path);
                            svg.selectAll(".focused").classed("focused", focused = false);
                }));

        var countryTooltip = d3.select("body").append("div").attr("class", "countryTooltip"),
                countryList = d3.select("body").append("select").attr("name", "countries");


        queue()
                .defer(d3.json, "json/world110.json")
                .defer(d3.tsv, "data/country-names.tsv")
                .await(ready);

        //Main function

        function ready(error, world, countryData) {

            var countryById = {},
                    countries = topojson.feature(world, world.objects.countries).features;


            //Adding countries to select
            countryData.forEach(function(d) {
                countryById[d.id] = d.name;
                option = countryList.append("option");
                option.text(d.name);
                option.property("value", d.id);
            });


            //Drawing countries on the globe
            var world = svg.selectAll("path.land")
                    .data(countries)
                    .enter().append("path")
                    .attr("class", "land")
                    .attr("d", path)

                //Drag event
                    .call(d3.behavior.drag()
                            .origin(function() { var r = projection.rotate(); return {x: r[0] / sens, y: -r[1] / sens}; })
                            .on("drag", function() {
                                var rotate = projection.rotate();
                                projection.rotate([d3.event.x * sens, -d3.event.y * sens, rotate[2]]);
                                svg.selectAll("path.land").attr("d", path);
                                svg.selectAll(".focused").classed("focused", focused = false);
                            }))

                //Mouse events
                    .on("mouseover", function(d) {
                        countryTooltip.text(countryById[d.id])
                                .style("left", (d3.event.pageX + 7) + "px")
                                .style("top", (d3.event.pageY - 15) + "px")
                                .style("display", "block")
                                .style("opacity", 1);
                    })
                    .on("mouseout", function(d) {
                        countryTooltip.style("opacity", 0)
                                .style("display", "none");
                    })
                    .on("mousemove", function(d) {
                        countryTooltip.style("left", (d3.event.pageX + 7) + "px")
                                .style("top", (d3.event.pageY - 15) + "px");
                    })
                    .on("click", function(d){
                        var searchQuery = countryById[d.id];
                        var destination = "http://localhost:9051/search?searchQuery=" + searchQuery;
                        var redirect = window.open(destination, "_blank").focus();
                        redirect.location;
                    });

            //Country focus on option select
            d3.select("select").on("change", function() {
                var rotate = projection.rotate(),
                        focusedCountry = country(countries, this),
                        p = d3.geo.centroid(focusedCountry);

                svg.selectAll(".focused").classed("focused", focused = false);

                //Globe rotating
                (function transition() {
                    d3.transition()
                            .duration(2500)
                            .tween("rotate", function() {
                                var r = d3.interpolate(projection.rotate(), [-p[0], -p[1]]);
                                return function(t) {
                                    projection.rotate(r(t));
                                    svg.selectAll("path").attr("d", path)
                                            .classed("focused", function(d, i) { return d.id == focusedCountry.id ? focused = d : false; });
                                };
                            })
                })();
            });

            function country(cnt, sel) {
                for(var i = 0, l = cnt.length; i < l; i++) {
                    if(cnt[i].id == sel.value) {return cnt[i];}
                }
            };
        };


    </script>

<!-- Scripts -->

</body>
</html>
